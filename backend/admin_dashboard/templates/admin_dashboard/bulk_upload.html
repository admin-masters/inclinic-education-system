{% extends "admin/base_site.html" %}
{% block content %}
<h1>Bulk Upload Field Reps (CSV)</h1>

<form method="post" enctype="multipart/form-data">
  {% csrf_token %}
  {{ form.as_p }}
  <input type="hidden" name="g-recaptcha-token" id="bulkRecaptcha">
  <button class="default" type="submit">Upload</button>
</form>

<p>CSV format (with or without header):<br>
<code>name,email,phone</code></p>

<a href="{% url 'admin_dashboard:dashboard' %}">‚Üê back to dashboard</a>

<script defer src="https://www.google.com/recaptcha/api.js?render={{ RECAPTCHA_SITE_KEY }}"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const siteKey = "{{ RECAPTCHA_SITE_KEY }}";
  const form = document.querySelector('form');
  form.addEventListener('submit', e => {
    e.preventDefault();
    grecaptcha.ready(() => {
      grecaptcha.execute(siteKey, { action: 'bulk' }).then(token => {
        document.getElementById('bulkRecaptcha').value = token;
        form.submit();
      });
    });
  });
});
</script>
{% endblock %}
