{% extends "base.html" %}
{% load static %}

{% block title %}Campaign Collaterals Input Form{% endblock %}

{% block content %}
<style>
  /* Two-column form layout */
  .form-horizontal .row {
    margin-bottom: 1.2rem;
  }

  .form-horizontal label {
    font-weight: 600;
    text-align: right;
    padding-right: 1rem;
    color: #222;
  }

  .form-horizontal .form-control,
  .form-horizontal select,
  .form-horizontal input[type="file"] {
    width: 100%;
    min-width: 180px;
    padding: 0.45rem 0.75rem;
    border-radius: 0.3rem;
    border: 1px solid #ccc;
    background: #fff;
  }

  .form-horizontal .form-control:focus {
    border-color: #007bff;
    box-shadow: 0 0 0 2px #e3f0ff;
  }

  .form-horizontal .text-muted {
    font-size: 0.92em;
  }

  .form-horizontal .errorlist {
    color: #d9534f;
    margin: 0.2em 0 0.5em 0;
    font-size: 0.97em;
    list-style: none;
    padding-left: 0;
  }

  .form-horizontal button[type="submit"] {
    padding: 0.5rem 2.5rem;
    font-size: 1.1rem;
    border-radius: 0.3rem;
    background: #007bff;
    color: #fff;
    border: none;
    font-weight: 600;
    transition: background 0.2s;
  }

  .form-horizontal button[type="submit"]:hover {
    background: #0056b3;
  }

  @media (max-width: 768px) {
    .form-horizontal label {
      text-align: left;
      padding-right: 0;
      margin-bottom: 0.3em;
    }

    .form-horizontal .row {
      flex-direction: column;
    }
  }
</style>
<div class="container mt-4">
  <h3 class="text-center fw-bold mb-4">Campaign Collaterals Input Form</h3>

  <form method="post" enctype="multipart/form-data" class="form-horizontal">
    {% csrf_token %}
    {% if collateral_form.errors %}
    <div class="alert alert-danger">
      <ul>
        {% for field in collateral_form %}
        {% for error in field.errors %}
        <li><strong>{{ field.label }}:</strong> {{ error }}</li>
        {% endfor %}
        {% endfor %}
        {% for error in collateral_form.non_field_errors %}
        <li>{{ error }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
    {{ collateral_form.non_field_errors }}

    <!-- Brand Campaign ID -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Brand Campaign ID :</label>
      <div class="col-sm-6">
        {% if brand_campaign_id %}
          <input type="text" class="form-control" value="{{ selected_campaign.brand_campaign_id }}" readonly>
          <input type="hidden" name="campaign" value="{{ selected_campaign.id }}">
        {% else %}
          {{ collateral_form.campaign }}
        {% endif %}
        {{ collateral_form.campaign.errors }}
      </div>
    </div>

    <!-- Purpose (select) -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Purpose of the Collateral:</label>
      <div class="col-sm-6">
        {{ collateral_form.purpose }}
        {{ collateral_form.purpose.errors }}
      </div>
    </div>

    <!-- Title -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Content Title:</label>
      <div class="col-sm-6">
        {{ collateral_form.title }}
        {{ collateral_form.title.errors }}
      </div>
    </div>

    <!-- Content ID -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Content ID:</label>
      <div class="col-sm-6">
        {{ collateral_form.content_id }}
        {{ collateral_form.content_id.errors }}
      </div>
    </div>

    <!-- Item Type -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Item Type :</label>
      <div class="col-sm-6">
        {{ collateral_form.type }}
        {{ collateral_form.type.errors }}
      </div>
    </div>

    <!-- PDF Upload / Video URL Wrapper -->
    <div class="row mb-3" id="asset-wrapper" style="min-height: 92px;">
      <div class="col-md-12" id="pdf-group">
        <div class="row align-items-center">
          <label class="col-sm-3 col-form-label fw-semibold text-end">PDF File:</label>
          <div class="col-sm-6">
            <small class="d-block text-muted">Keep the PDF size less than 2MB</small>
            {{ collateral_form.file }}
            {{ collateral_form.file.errors }}
          </div>
        </div>
      </div>
      <div class="col-md-12 d-none" id="video-group">
        <div class="row align-items-center">
          <label class="col-sm-3 col-form-label fw-semibold text-end">Vimeo URL:</label>
          <div class="col-sm-6">
            {{ collateral_form.vimeo_url }}
            {{ collateral_form.vimeo_url.errors }}
          </div>
        </div>
      </div>
    </div>

    <!-- Banner 1 Upload -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Banner 1 upload:</label>
      <div class="col-sm-6">
        <small class="d-block text-muted">Keep the Image size less than 2MB</small>
        {{ collateral_form.banner_1 }}
        {{ collateral_form.banner_1.errors }}
      </div>
    </div>

    <!-- Banner 2 Upload -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Banner 2 upload:</label>
      <div class="col-sm-6">
        <small class="d-block text-muted">Keep the Image size less than 2MB</small>
        {{ collateral_form.banner_2 }}
        {{ collateral_form.banner_2.errors }}
      </div>
    </div>

    <!-- Doctor's Name -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Doctor's Name:</label>
      <div class="col-sm-6">
        {{ collateral_form.doctor_name }}
        {{ collateral_form.doctor_name.errors }}
      </div>
    </div>

    <!-- Description (Content Description) -->
    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Content Description:</label>
      <div class="col-sm-6">
        {{ collateral_form.description }}
        {{ collateral_form.description.errors }}
      </div>
    </div>

    <!-- Webinar block -->
    <div class="row mb-2">
      <div class="col-sm-9 offset-sm-3">
        <h6 class="text-muted mt-2">Optional Webinar</h6>
      </div>
    </div>

    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">DIAP Webinar Link:</label>
      <div class="col-sm-6">
        {{ collateral_form.webinar_url }}
        {{ collateral_form.webinar_url.errors }}
      </div>
    </div>

    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Webinar Title:</label>
      <div class="col-sm-6">
        {{ collateral_form.webinar_title }}
        {{ collateral_form.webinar_title.errors }}
      </div>
    </div>

    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Webinar Description:</label>
      <div class="col-sm-6">
        {{ collateral_form.webinar_description }}
        {{ collateral_form.webinar_description.errors }}
      </div>
    </div>

    <div class="row mb-3 align-items-center">
      <label class="col-sm-3 col-form-label fw-semibold text-end">Webinar Date:</label>
      <div class="col-sm-6">
        {{ collateral_form.webinar_date }}
        {{ collateral_form.webinar_date.errors }}
      </div>
    </div>

    <!-- Submit -->
    <div class="row mb-3">
      <div class="offset-sm-3 col-sm-6">
        <button type="submit" class="btn btn-primary px-4">Submit</button>
      </div>
    </div>
  </form>
</div>
{% endblock %}

{% block bottomjs %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const typeField = document.getElementById("id_type");
    const pdfGroup = document.getElementById("pdf-group");
    const videoGroup = document.getElementById("video-group");

    function toggleFields() {
      const type = typeField.value;
      const isPdf = type === 'pdf';
      const isVideo = type === 'video';
      const isBoth = type === 'pdf_video';
      pdfGroup.classList.toggle('d-none', !(isPdf || isBoth));
      videoGroup.classList.toggle('d-none', !(isVideo || isBoth));
    }

    typeField.addEventListener("change", toggleFields);
    toggleFields(); // run on load
  });
</script>
{% endblock %}