{% extends "base.html" %}
{% load static %}

{% block content %}
{% if verified and collateral %}
<div class="container mt-4">
  <div class="card mx-auto" style="max-width: 800px;">
    <div class="card-header text-center">
      <h4 class="mb-0">{{ collateral.title }}</h4>
      {% if collateral.description %}
      <p class="text-muted mb-0">{{ collateral.description }}</p>
      {% endif %}
    </div>
    <div class="card-body text-center">


      {% if collateral.type == 'pdf' %}
      {% if collateral.file %}
      <a href="{{ collateral.file.url }}" class="btn btn-primary mb-3" target="_blank"
        style="background:#1877f2; border:none;">CLICK HERE to download the PDF</a>
      <p>If you are not able to see the PDF, please refresh the page!</p>

      <!-- Try multiple PDF display methods -->
      <div class="pdf-container" style="border:1px solid #ccc; height:600px; overflow:hidden;">
        <!-- Method 1: Object tag (better for PDFs) -->
        <object data="{{ collateral.file.url }}" type="application/pdf" width="100%" height="100%">
          <!-- Fallback: Iframe -->
          <iframe src="{{ collateral.file.url }}" width="100%" height="100%" style="border:none;"></iframe>
        </object>
      </div>

      <!-- Alternative: Direct link -->
      <div class="mt-3">
        <p><strong>If PDF doesn't display above, click here:</strong></p>
        <a href="{{ collateral.file.url }}" class="btn btn-outline-primary" target="_blank">
          Open PDF in New Tab
        </a>
      </div>
      {% else %}
      <div class="alert alert-warning">
        <h5>PDF File Not Available</h5>
        <p>This collateral doesn't have an associated PDF file.</p>
        <p><strong>Title:</strong> {{ collateral.title }}</p>
        {% if collateral.description %}
        <p><strong>Description:</strong> {{ collateral.description }}</p>
        {% endif %}
      </div>
      {% endif %}
      {% elif collateral.type == 'video' %}
      {% if collateral.vimeo_url %}
      <div class="ratio ratio-16x9">
        <iframe src="{{ collateral.vimeo_url }}" allowfullscreen></iframe>
      </div>
      {% else %}
      <div class="alert alert-warning">
        <h5>Video Not Available</h5>
        <p>This collateral doesn't have an associated video URL.</p>
      </div>
      {% endif %}
      {% else %}
      <div class="alert alert-info">
        <h5>Content Preview</h5>
        <p><strong>Title:</strong> {{ collateral.title }}</p>
        {% if collateral.description %}
        <p><strong>Description:</strong> {{ collateral.description }}</p>
        {% endif %}
        <p><strong>Type:</strong> {{ collateral.type }}</p>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% else %}
<div class="d-flex justify-content-center align-items-center" style="min-height: 80vh; background: #fff;">
  <div class="card shadow" style="width: 100%; max-width: 400px;">
    <div class="card-body p-4">
      <h3 class="text-center mb-4">Access Denied</h3>
      <p class="text-center text-muted">Please verify your WhatsApp number to access this content.</p>
      <a href="{% url 'doctor_collateral_verify' %}" class="btn btn-primary w-100"
        style="background:#1877f2; border:none;">Go Back to Verification</a>
    </div>
  </div>
</div>
{% endif %}
{% endblock %}